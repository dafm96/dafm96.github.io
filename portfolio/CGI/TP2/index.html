<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="object_viewer.css">
        <script id="vertex-shader" type="x-shader/x-vertex">
            const vec4 lightPosition = vec4(0.0, 1.8, 1.3, 1.0);

			attribute vec4 vPosition;   // vertex position in modelling coordinates
			attribute vec4 vNormal;     // vertex normal in modelling coordinates

			uniform mat4 mModelView;    // model-view transformation
			uniform mat4 mNormals;      // model-view transformation for normals
			uniform mat4 mProjection;   // projection matrix

			varying vec3 fNormal;       // normal vector in camera space (to be interpolated)
			varying vec3 fLight;
			varying vec3 fViewer;

			void main(){
			    // compute position in camera frame
			    vec3 posC = (mModelView * vPosition).xyz;
			    
			    // compute normal in camera frame
			    fNormal = (mNormals * vNormal).xyz;

			    // compute light vector in camera frame
			    if(lightPosition.w == 0.0) 
			        fLight = normalize((mNormals * lightPosition).xyz);
			    else 
			        fLight = normalize((mNormals*lightPosition).xyz - posC);
			    
			    // Compute the view vector
			    // fViewer = -fPosition; // Perspective projection
			    fViewer = vec3(0,0,1); // Parallel projection only

			    // Compute vertex position in clip coordinates (as usual)
			    gl_Position = mProjection * mModelView * vPosition;
			}
        </script>
        <script id="fragment-shader" type="x-shader/x-fragment">
            precision mediump float;

			varying vec3 fPosition;
			varying vec3 fNormal;

			const vec3 materialAmb = vec3(1.0, 0.0, 0.0);
			const vec3 materialDif = vec3(1.0, 0.0, 0.0);
			const vec3 materialSpe = vec3(1.0, 1.0, 1.0);
			const float shininess = 6.0;

			const vec3 lightAmb = vec3(0.2, 0.2, 0.2);
			const vec3 lightDif = vec3(0.7, 0.7, 0.7);
			const vec3 lightSpe = vec3(1.0, 1.0, 1.0);

			vec3 ambientColor = lightAmb * materialAmb;
			vec3 diffuseColor = lightDif * materialDif;
			vec3 specularColor = lightSpe * materialSpe;

			varying vec3 fLight;
			varying vec3 fViewer;

			void main() {

			    vec3 L = normalize(fLight);
			    vec3 V = normalize(fViewer);
			    vec3 N = normalize(fNormal);
			   
			    // Compute the halfway vector for Phong-Blinn model
			    vec3 H = normalize(L+V);

			    // compute diffuse reflection, don't let the vertex be illuminated from behind...
			    float diffuseFactor = max( dot(L,N), 0.0 );
			    vec3 diffuse = diffuseFactor * diffuseColor;

			    // compute specular reflection
			    float specularFactor = pow(max(dot(N,H), 0.0), shininess);
			    vec3 specular = specularFactor * specularColor;

			    // specular reflection should be 0 if normal is pointing away from light source
			    if( dot(L,N) < 0.0 ) {
			        specular = vec3(0.0, 0.0, 0.0);
			    }

			    // add all 3 components from the illumination model (ambient, diffuse and specular)
			    gl_FragColor = vec4(ambientColor + diffuse + specular, 1.0);
			}
        </script>
        <!--
        <script id="vertex-shader-2" type="x-shader/x-vertex">
        </script>
        <script id="fragment-shader-2" type="x-shader/x-vertex">
        </script>
        -->
        <script type="text/javascript" src="../Common/webgl-utils.js"></script>
        <script type="text/javascript" src="../Common/initShaders.js"></script>
        <script type="text/javascript" src="../Common/MV.js"></script>
        <script type="text/javascript" src="../Common/sphere.js"></script>
        <script type="text/javascript" src="../Common/cube.js"></script>      
        <script type="text/javascript" src="pyramid.js"></script>     
        <script type="text/javascript" src="torus.js"></script> 
        <script type="text/javascript" src="object_viewer.js"></script>
    </head>
    <body>
        <div id="singlepagecontainer">
            <div id="interfacearea">
                <br>
                
                <div>VTX : <input type="file" id="vertex" value="/shaders/vtx-phong.glsl"></div>
                <div>FRG : <input type="file" id="fragment" value="/shaders/frg-phong.glsl"></div>
                <br>
                
                Choose the polygon:
                <select id="polygon">
                    <option value="0">Sphere</option>
                    <option value="1">Cube</option>
                    <option value="2">Pyramid</option>
                    <option value="3">Torus</option>
                </select>
                <br>
                <br>
                Filling:
                <select id = "fill">
                    <option value ="0">WireFrame</option>
                    <option value="1">Filled</option>
                </select>
                <br>
                <br>
                Projeccao:
                <select id="projection" class="chooseproj">
                    <option value="Perspetiva">Perspetiva</option>
                    <option value="Axonometrica">Axonometrica</option>
                    <option value="Obliqua">Obliqua</option>
                </select>
                <br>
                <br>
                <div id="Perspetiva">Valor d:<input id="perspetiva-d" type="range" value="3" min="1" max="20" step="0.1"></div>
                <div id="Axonometrica" style="display:none">
                    Valor Theta:<input id="axo-theta" type="range" value="0" min="-180" max="180" step="0.1">
                    <br>
                    Valor Gamma:<input id="axo-gamma" type="range" value="0" min="-180" max="180" step="0.1">
                </div>
                <div id="Obliqua" style="display:none">
                    Valor l:<input id="obliqua-l" type="range" value="1" min="0" max="1" step="0.01">
                    <br>
                    Valor a:<input id = "obliqua-b" type="range" value="45" min="-180" max="180" step="1">
            </div>
            </div>
            <div id="viewarea">
                <canvas id="gl-canvas">
                    Oops... your browser doesn't support the HTML5 canvas element"
                </canvas>
            </div>
        </div>
    </body>
</html>
