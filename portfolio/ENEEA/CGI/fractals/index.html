<!DOCTYPE html>
<html>
<head>
<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 vPosition;
varying vec4 fPosition;

void main(){
    gl_Position = vPosition;
    fPosition = vPosition;
}
</script>
    
    
<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;
varying vec4 fPosition;
uniform vec2 desl;
uniform float factorS;
uniform float scale;
uniform int fractalType;
const int maxIt = 100;

int fractal(vec2 z0, vec2 c) {
    int n;
    vec2 z = z0;
    for(int i = 0; i <= maxIt; i++) {
        z = vec2(z.x*z.x-z.y*z.y, 2.0*z.x*z.y) + c;
        n = i;
        if((z.x*z.x + z.y*z.y) > 4.0) 
            break;
    }
    
   if( n == maxIt){ 
    	return -1;
    }else{
    	return n;
    }
}

vec3 paletize(float v, float factor) {
    float vv = v*factor;
    if(v == -1.0){
        return vec3(0.0, 0.0, 0.0);
    }
    return vec3(sin(vv/3.0), cos(vv/6.0), cos(vv/(12.0+3.14/4.0)));
}

void main() {
	if(fractalType == 0){
		gl_FragColor = vec4(paletize(float(fractal(vec2(0.0, 0.0), vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y))), factorS), 1.0);        
	}
    if(fractalType == 1){
		gl_FragColor = vec4(paletize(float(fractal(vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y), vec2(-0.4, 0.6))), factorS), 1.0);
	}
    if(fractalType == 2){
		gl_FragColor = vec4(paletize(float(fractal(vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y), vec2(0.285, 0.0))), factorS), 1.0);
	}
    if(fractalType == 3){
		gl_FragColor = vec4(paletize(float(fractal(vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y), vec2(0.285, 0.01))), factorS), 1.0);
	}
    if(fractalType == 4){
		gl_FragColor = vec4(paletize(float(fractal(vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y), vec2(-0.8, 0.156))), factorS), 1.0);
	}
    if(fractalType == 5){
		gl_FragColor = vec4(paletize(float(fractal(vec2(fPosition.x/scale + desl.x, fPosition.y/scale + desl.y), vec2(0.8, 0.0))), factorS), 1.0);
	}
    
    
}
</script>
<script type="text/javascript" src="../Common/webgl-utils.js"></script>
<script type="text/javascript" src="../Common/initShaders.js"></script>
<script type="text/javascript" src="../Common/MV.js"></script>
<script type="text/javascript" src="fractal.js"></script>
</head>
<body>
    <title>Fractals</title>
    <canvas id="gl-canvas" width="600" height="600" style="display: block; margin: 0 auto;">
        Oops... your browser doesn't support the HTML5 canvas element"
    </canvas>
    <div align="center">
        Factor:
        <span style="display:inline-block; width: 5px;"></span>
        <input id = "slider" type="range" value="1" min="0.1" max="2" step="0.01">
        <span style="display:inline-block; width: 30px;"></span>
        Fractal type:
        <span style="display:inline-block; width: 5px;"></span>
    <select id = "box" onChange="changeFunction()">
    	<option value = "0">Mandelbrot</option>
    	<option value = "1">Julia -0.4+0.6i</option>
        <option value = "2">Julia 0.285+0i</option>
        <option value = "3">Julia 0.285+0.01i</option>
        <option value = "4">Julia -0.8+0.156i</option>
        <option value = "5">Julia 0.8+0i</option>
    </select>
    </div>
</body>
</html>
